<p>Enables fine-grained fixup of <code>xml:id</code> attributes after transclusion.</p>
<h2 id="parameters">Parameters</h2>
<p><code>[idRole]</code></p>
<ul>
<li><strong>idRole</strong> (URI) — A URI which identifies the ID fixup XLink role. Default is <a href="http://stanleysecurity.github.io/PACBook/role/id">http://stanleysecurity.github.io/PACBook/role/id</a>.</li>
</ul>
<h2 id="input">Input</h2>
<p>An XML document containing extended links to fix up transcluded XML IDs as described below.</p>
<h2 id="output">Output</h2>
<p>An XML document, identical to the input except that XML IDs are fixed up.</p>
<h2 id="description">Description</h2>
<p>This stylesheet is useful if you have a subdocument which contains XML IDs and which must be transcluded into an assembly file or master document in two or more places. In order to avoid validation errors, each ID must be unique. The process of making duplicate IDs unique is called ID fixup. Other ID fixup mechanisms take a blanket approach to fixup, e.g. by adding a suffix to each ID in the transcluded subdocuments. This stylesheet is useful for cases when a fine-grained approach is required. It enables you to specify by hand how each transcluded ID should be fixed up, using XLinks.</p>
<p>In the assembly file or master document, at each point where you want to transclude the target subdocument, you must add an extended link element with the <code>xl:role</code> attribute set to the specified fixup role URI. For each ID that will need fixing up, this extended link should contain:</p>
<ol>
<li><p>A locator element with an <code>xl:label</code> attribute unique within the extended link, whose <code>xl:href</code> attribute points to one <code>xml:id</code> attribute in the subdocument.</p></li>
<li><p>A locator element with an <code>xl:label</code> attribute unique within the extended link, whose <code>xl:href</code> attribute points to the new ID that you want the target subdocument to use.</p></li>
<li><p>An arc element whose <code>xl:from</code> attribute is set to the <code>xl:label</code> attribute of the start locator and whose <code>xl:to</code> attribute is set to the <code>xl:label</code> attribute of the fixup locator.</p></li>
</ol>
<p>When run, the stylesheet recurses through the document and copies each element. If any element has an <code>xml:id</code> attribute, the stylesheet looks for the nearest ancestor element which contains an extended link whose <code>xl:role</code> attribute is set to the specified ID fixup role URI <em>and</em> which contains a locator element whose <code>xl:href</code> attribute points to the current <code>xml:id</code> attribute. If it finds a matching locator, the stylesheet follows the arc to the target locator and replaces the value of the current <code>xml:id</code> attribute with the value indicated by the target locator’s <code>xl:href</code> attribute.</p>
<p>You should run this stylesheet immediately after transclusion. If any of your translation strings contain <code>xml:id</code> attributes, you may need to run this stylesheet again immediately after translation.</p>
<p>After you have fixed up IDs, you may also need to fix up cross references or links that point to those IDs. See <a href="TransLinks.xsl">TransLinks.xsl</a>.</p>
<h2 id="roadmap">Roadmap</h2>
<p>At present this stylesheet requires that the extended links, locators and arcs are DocBook <code>&lt;extendedlink&gt;</code>, <code>&lt;locator&gt;</code> and <code>&lt;arc&gt;</code> elements, meaning that the stylesheet only works with DocBook. In future releases, this stylesheet will be updated to work with any elements with attributes <code>xl:type='extended'</code>, <code>xl:type='locator'</code> or <code>xl:type='arc'</code>. This will make the stylesheets work with any XLink-compliant XML schema, including DocBook 5.1.</p>
